
<!DOCTYPE html>
<html lang="en" class="loading">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Writeup - Nullcon-17 EasyPeasy - cyb3rsaurus</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="cyb3rsaurus Kotlin Tutorials kh4l khal Educational,"> 
    <meta name="description" content="[Writeup]Nullcon-17 EasyPeasyTo begin with, the challenge name suggests that it is easypeasy. but, ,"> 
    <meta name="author" content="kh4l"> 
    <link rel="alternative" href="atom.xml" title="cyb3rsaurus" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link href="/font/Rubik-Bold-kern-latin.woff2" as="font" type="font/woff2" crossorigin>
    <link href="/font/Rubik-Regular-kern-latin.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nuy6s3evgdk.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.7.2/animate.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
    <link rel="stylesheet" href="/css/obsidian.css">
    <link rel="stylesheet" href="/css/ball-atom.min.css">
</head>
</html>
<body class="loading">
    <div class="la-ball-atom la-2x">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
    <span id="config-title" style="display:none">cyb3rsaurus</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a id="home-icon" class="image-icon icon-home iconfont animated fadeIn" href="javascript:;" data-url=""></a>
    <div id="play-icon" title="Play/Pause" class="iconfont icon-play animated fadeIn"></div>
    <h3 class="subtitle">Writeup - Nullcon-17 EasyPeasy</h3>
    <div class="social">
<!--        <div class="like-icon">-->
<!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
<!--        </div>-->
        <div>
            <div class="share animated fadeIn">
                
                    <a href="javascript:;" class="iconfont icon-share1"></a>
                    <div class="share-component-cc" data-disabled="facebook,linkedin,diandian,tencent,google"></div>
                
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class= article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url(/img/cover.jpg);">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                    <a href="/categories/Writeups"><b>「 </b>WRITEUPS<b> 」</b></a>
                
                August 20, 2019
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/[Writeup]Nullcon-17 EasyPeasy/" title="Writeup - Nullcon-17 EasyPeasy">Writeup - Nullcon-17 EasyPeasy</a></h3>
            
                <p class="post-count animated fadeInDown">
                    
                        <span>
                        <b class="iconfont icon-text2"></b> <i>Words count</i>
                        7.4k
                    </span>
                    
                    
                        <span>
                        <b class="iconfont icon-timer__s"></b> <i>Reading time</i>
                        7 mins.
                    </span>
                    
                    
                    
                        <span id="busuanzi_container_page_pv">
                            <b class="iconfont icon-read"></b> <i>Read count</i>
                            <span id="busuanzi_value_page_pv">0</span>
                        </span>
                    
                </p>
            
            
                <ul class="animated fadeInDown post-tags-list"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/Writeup/">Writeup</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn slower">
            <h1 id="Writeup-Nullcon-17-EasyPeasy"><a href="#Writeup-Nullcon-17-EasyPeasy" class="headerlink" title="[Writeup]Nullcon-17 EasyPeasy"></a>[Writeup]Nullcon-17 EasyPeasy</h1><p>To begin with, the challenge name suggests that it is easypeasy. but, that is a bummer. It is a bit  complicated. The things that it is a stripped binary and is written in C++ makes it a difficult one. Atleast, it is complicated to me. lets begin by looking at the pseudocode. (It’s little bit messy, please bear with me -_- )</p>
<pre><code>v40 = __readfsqword(0x28u);
  v3 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;welcome to easypeasy.&quot;, a2);
  std::ostream::operator&lt;&lt;(v3, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
  sub_401EFC(&amp;v31);
  std::string::string((std::string *)&amp;v24);
  MD5_Init(&amp;v34);
  SHA1_Init(&amp;v35);
  for ( i = 0LL; i &lt;= 6; ++i )
  {
    sub_40146D(&amp;v31, i);
    v4 = (_QWORD *)std::getline&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;std::cin, &amp;v24);
    if ( std::basic_ios&lt;char,std::char_traits&lt;char&gt;&gt;::operator void *((char *)v4 + *(_QWORD *)(*v4 - 24LL)) == 0 )
    {
      std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;The flag is ....&quot;, v5);
      sleep(0x283Au);
      a3 = -2;
      goto LABEL_24;
    }
    std::allocator&lt;char&gt;::allocator(&amp;v33);
    v6 = std::string::end((std::string *)&amp;v24);
    v7 = std::string::begin((std::string *)&amp;v24);
    sub_401F7C(&amp;v32, v7, v6, &amp;v33);
    std::allocator&lt;char&gt;::~allocator(&amp;v33);
    sub_401B36(&amp;v25, &amp;v32);
    sub_40204C(&amp;v33, &amp;v31);
    LOBYTE(v6) = sub_401B50(&amp;v25, &amp;v33, &amp;v26);
    sub_401F16(&amp;v33);
    if ( (_BYTE)v6 )
    {
      v9 = sub_4014D9(i);
      v10 = qword_6052A0[i + v9];
      if ( v10 == v26 )
      {
        v11 = std::string::size((std::string *)&amp;v24);
        v12 = std::string::c_str((std::string *)&amp;v24);
        MD5_Update(&amp;v34, v12, v11);
        v13 = std::string::size((std::string *)&amp;v24);
        v14 = std::string::c_str((std::string *)&amp;v24);
        SHA1_Update(&amp;v35, v14, v13);
        v17 = 1;
      }
      else
      {
        v15 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;Not good enough.&quot;, v10);
        std::ostream::operator&lt;&lt;(v15, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
        a3 = -3;
        v17 = 0;
      }
    }
    else
    {
      v16 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;This is supposed to be easy.&quot;, v8);
      std::ostream::operator&lt;&lt;(v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
      a3 = -1;
      v17 = 0;
    }
    sub_401FE6(&amp;v32);
    if ( v17 != 1 )
      goto LABEL_24;
  }
  MD5_Final(v36, &amp;v34);
  SHA1_Final(v37, &amp;v35);
  for ( j = 0LL; j &lt;= 0xF; ++j )
    sprintf(&amp;s1[2 * j], &quot;%02x&quot;, (unsigned __int8)v36[j]);
  for ( k = 0LL; k &lt;= 0x13; ++k )
    sprintf(&amp;v39[2 * k], &quot;%02x&quot;, (unsigned __int8)v37[k]);
  if ( !strcmp(s1, &quot;3d5f443a57358deb84191dec1bfc65fe&quot;) )
  {
    v19 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;That was easy anyways.&quot;, v18);
    std::ostream::operator&lt;&lt;(v19, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
    std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;Here is your flag: flag{&quot;, v20);
    for ( l = 0LL; l &lt;= 0x27; ++l )
      std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(
        &amp;std::cout,
        (unsigned int)(char)(v39[l] ^ (unsigned __int64)qword_605340[l]));
    v22 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;}&quot;, v21);
    std::ostream::operator&lt;&lt;(v22, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
  }
  a3 = 0;
LABEL_24:
  std::string::~string((std::string *)&amp;v24);
  sub_401F16(&amp;v31);
  return a3;
}</code></pre><blockquote>
<p>I used IDA for the pseudocode. </p>
</blockquote>
<!-- wp:paragraph -->
<p>From the above code, you can see that there is a loop that iterates seven times which means that takes seven strings as input. And you can also observe that various functions are being called and our input is being hashed using MD5 and SHA. And at the end, it is compared with a string. i.e, our flag that is undergone MD5 and SHA hashed. Becoming more complicated -_-</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It becomes easy when you figure out that there is a function that checks our input, in which basic comparison is going on. Using GDB, diving into the function,  we can find that the exact comparison starts from here, <strong>0x401bc6</strong>. Lets start keeping a breakpoint here. In this location, you can see that our input is being stored(for comparison? :) ).</p>
<!-- /wp:paragraph -->
```
 0x401bc6:    mov    BYTE PTR [rbp-0x25],al
```

<p>After this, the function checks if the byte from the input string is number or not(+,-,*,/). if the number byte is a numaric value, these instructions are followed next.</p>
<pre><code>   0x401bed:    sub    eax,0x30
   0x401bf0:    cdqe   
   0x401bf2:    mov    QWORD PTR [rbp-0x18],rax
   0x401bf6:    cmp    QWORD PTR [rbp-0x18],0x0
   0x401bfb:    js     0x401c04
   0x401bfd:    cmp    QWORD PTR [rbp-0x18],0x9
   0x401c02:    jle    0x401c0e</code></pre><p>the comparison happens here.</p>
<pre><code>   0x401cb7:    cmp    rax,QWORD PTR [rbp-0x8]
   0x401cbb:    je     0x401cc4
   0x401cbd:    mov    eax,0x1
   0x401cc2:    jmp    0x401cc9
   0x401cc4:    mov    eax,0x0
   0x401cc9:    test   al,al
   0x401ccb:    je     0x401cd7
   0x401ccd:    mov    eax,0x0
   0x401cd2:    jmp    0x401dd7
   0x401cd7:    mov    eax,DWORD PTR [rbp-0x24]</code></pre><p>If the selected byte is character(+,-,*,/), this function is called</p>
<pre><code>   0x401bc9:    cmp    BYTE PTR [rbp-0x27],0x0
   0x401bcd:    je     0x401be2
   0x401bcf:    movsx  eax,BYTE PTR [rbp-0x25]
   0x401bd3:    mov    edi,eax
=&gt; 0x401bd5:    call   0x401ad7
</code></pre><p>this is what happening in the function(<strong>0x401ad17</strong>)</p>
<pre><code>   0x401add:    mov    BYTE PTR [rbp-0x14],al
   0x401ae0:    movsx  eax,BYTE PTR [rbp-0x14]
   0x401ae4:    sub    eax,0x28
   0x401ae7:    cdqe   
   0x401ae9:    mov    QWORD PTR [rbp-0x8],rax
   0x401aed:    mov    rax,QWORD PTR [rbp-0x8]
   0x401af1:    cmp    rax,0x3
   0x401af5:    je     0x401b13
   0x401af7:    cmp    rax,0x3
   0x401afb:    jg     0x401b05
   0x401afd:    cmp    rax,0x2
   0x401b01:    je     0x401b21
   0x401b03:    jmp    0x401b2f
   0x401b05:    cmp    rax,0x5
   0x401b09:    je     0x401b1a
   0x401b0b:    cmp    rax,0x7</code></pre><p>Again the selected character byte is compared as usually. After the completion of the first input, the MD5 hash and SHA hash are updated here</p>
<pre><code>   0x40172e:    call   0x401110 &lt;MD5_Update@plt&gt;
   0x401767:    call   0x401140 &lt;SHA1_Update@plt&gt;</code></pre><p>Repeat the process for seven times and the correct value inputs will print you flag.</p>
<p>I hope this helps in solving the challenge. :)</p>
<blockquote>
<p>The flag is, flag{c0u8a_3dgety7_33hygt_donfos_9uck3d_up_NN}</p>
</blockquote>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                </ul>
            
            
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="/logo.png" height=300 width=300></img>
                    <p>kh4l</p>
                    <span>Plant a Tree for every successful compilation</span>
                    <dl>
                        <dd><a href="https://github.com/KalyanVem" target="_blank"><span class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="https://twitter.com/kalyan_vem" target="_blank"><span class=" iconfont icon-twitter"></span></a></dd>
                        <dd><a href="" target="_blank"><span class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl>
                </div>
                <ul>
                    <li><a href="/">5 <p>Articles</p></a></li>
                    <li><a href="/categories">4 <p>Categories</p></a></li>
                    <li><a href="/tags">3 <p>Tags</p></a></li>
                </ul>
            </div>
            
                
                
                    <div class="box sticky animated fadeInRight faster">
                        <div id="toc" class="subbox">
                            <h4>Contents</h4>
                            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Writeup-Nullcon-17-EasyPeasy"><span class="toc-number">1.</span> <span class="toc-text">[Writeup]Nullcon-17 EasyPeasy</span></a></li></ol>
                        </div>
                    </div>
                
            
        </div>
    </div>
</div>


    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p class="copyright" id="copyright">
        &copy; 2019
        <span class="gradient-text">
            kh4l
        </span>.
        <br>
        <span class="gradient-text">
            Peace
        </span>
        
    </p>
</footer>

<script src="//cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="//cdn.bootcss.com/typed.js/2.0.10/typed.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>


    <script src="/js/busuanzi.min.js"></script>
    <script>
        $(document).ready(function () {
            if ($('span[id^="busuanzi_"]').length) {
                initialBusuanzi();
            }
        });
    </script>


<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






    <!-- Highlight.js -->
    <link rel="stylesheet" href="/css/dracula.css">
    <script src="//cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js">
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightBlock(block);
            });
        });
    </script>


<script>
    function initialTyped () {
        var typedTextEl = $('.typed-text');
        if (typedTextEl && typedTextEl.length > 0) {
            var typed = new Typed('.typed-text', {
                strings: ["Plant a Tree for every successful compilation", "It&#39;s Hard to Read Code Than to Write it"],
                typeSpeed: 90,
                loop: true,
                loopCount: Infinity,
                backSpeed: 20,
            });
        }
    }

    if ($('.article-header') && $('.article-header').length) {
        $(document).ready(function () {
            initialTyped();
        });
    }
</script>


</html>
