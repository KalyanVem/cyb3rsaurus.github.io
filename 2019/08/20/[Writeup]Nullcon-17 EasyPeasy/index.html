<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Writeup - Nullcon-17 EasyPeasy"><meta name="keywords" content="Writeup"><meta name="author" content="kh4l"><meta name="copyright" content="kh4l"><title>Writeup - Nullcon-17 EasyPeasy | cyb3rsaurus</title><link rel="shortcut icon" href="/logo.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-...........',
  enable_page_level_ads: 'true'
});
</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Writeup-Nullcon-17-EasyPeasy"><span class="toc-text">[Writeup]Nullcon-17 EasyPeasy</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">kh4l</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/kalyanvem">GitHub</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">3</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">2</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://img.vim-cn.com/cc/b3c73e9001c2c42a03e13fc1a3cd57afe5734c.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">cyb3rsaurus</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">Writeup - Nullcon-17 EasyPeasy</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-20</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Tutorials/">Tutorials</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="Writeup-Nullcon-17-EasyPeasy"><a href="#Writeup-Nullcon-17-EasyPeasy" class="headerlink" title="[Writeup]Nullcon-17 EasyPeasy"></a>[Writeup]Nullcon-17 EasyPeasy</h1><p>To begin with, the challenge name suggests that it is easypeasy. but, that is a bummer. It is a bit  complicated. The things that it is a stripped binary and is written in C++ makes it a difficult one. Atleast, it is complicated to me. lets begin by looking at the pseudocode. (Itâ€™s little bit messy, please bear with me -_- )</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">v40 = __readfsqword(0x28u);</span><br><span class="line">  v3 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;welcome to easypeasy.&quot;, a2);</span><br><span class="line">  std::ostream::operator&lt;&lt;(v3, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</span><br><span class="line">  sub_401EFC(&amp;v31);</span><br><span class="line">  std::string::string((std::string *)&amp;v24);</span><br><span class="line">  MD5_Init(&amp;v34);</span><br><span class="line">  SHA1_Init(&amp;v35);</span><br><span class="line">  for ( i = 0LL; i &lt;= 6; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_40146D(&amp;v31, i);</span><br><span class="line">    v4 = (_QWORD *)std::getline&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;std::cin, &amp;v24);</span><br><span class="line">    if ( std::basic_ios&lt;char,std::char_traits&lt;char&gt;&gt;::operator void *((char *)v4 + *(_QWORD *)(*v4 - 24LL)) == 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;The flag is ....&quot;, v5);</span><br><span class="line">      sleep(0x283Au);</span><br><span class="line">      a3 = -2;</span><br><span class="line">      goto LABEL_24;</span><br><span class="line">    &#125;</span><br><span class="line">    std::allocator&lt;char&gt;::allocator(&amp;v33);</span><br><span class="line">    v6 = std::string::end((std::string *)&amp;v24);</span><br><span class="line">    v7 = std::string::begin((std::string *)&amp;v24);</span><br><span class="line">    sub_401F7C(&amp;v32, v7, v6, &amp;v33);</span><br><span class="line">    std::allocator&lt;char&gt;::~allocator(&amp;v33);</span><br><span class="line">    sub_401B36(&amp;v25, &amp;v32);</span><br><span class="line">    sub_40204C(&amp;v33, &amp;v31);</span><br><span class="line">    LOBYTE(v6) = sub_401B50(&amp;v25, &amp;v33, &amp;v26);</span><br><span class="line">    sub_401F16(&amp;v33);</span><br><span class="line">    if ( (_BYTE)v6 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = sub_4014D9(i);</span><br><span class="line">      v10 = qword_6052A0[i + v9];</span><br><span class="line">      if ( v10 == v26 )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = std::string::size((std::string *)&amp;v24);</span><br><span class="line">        v12 = std::string::c_str((std::string *)&amp;v24);</span><br><span class="line">        MD5_Update(&amp;v34, v12, v11);</span><br><span class="line">        v13 = std::string::size((std::string *)&amp;v24);</span><br><span class="line">        v14 = std::string::c_str((std::string *)&amp;v24);</span><br><span class="line">        SHA1_Update(&amp;v35, v14, v13);</span><br><span class="line">        v17 = 1;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        v15 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;Not good enough.&quot;, v10);</span><br><span class="line">        std::ostream::operator&lt;&lt;(v15, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</span><br><span class="line">        a3 = -3;</span><br><span class="line">        v17 = 0;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">      v16 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;This is supposed to be easy.&quot;, v8);</span><br><span class="line">      std::ostream::operator&lt;&lt;(v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</span><br><span class="line">      a3 = -1;</span><br><span class="line">      v17 = 0;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_401FE6(&amp;v32);</span><br><span class="line">    if ( v17 != 1 )</span><br><span class="line">      goto LABEL_24;</span><br><span class="line">  &#125;</span><br><span class="line">  MD5_Final(v36, &amp;v34);</span><br><span class="line">  SHA1_Final(v37, &amp;v35);</span><br><span class="line">  for ( j = 0LL; j &lt;= 0xF; ++j )</span><br><span class="line">    sprintf(&amp;s1[2 * j], &quot;%02x&quot;, (unsigned __int8)v36[j]);</span><br><span class="line">  for ( k = 0LL; k &lt;= 0x13; ++k )</span><br><span class="line">    sprintf(&amp;v39[2 * k], &quot;%02x&quot;, (unsigned __int8)v37[k]);</span><br><span class="line">  if ( !strcmp(s1, &quot;3d5f443a57358deb84191dec1bfc65fe&quot;) )</span><br><span class="line">  &#123;</span><br><span class="line">    v19 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;That was easy anyways.&quot;, v18);</span><br><span class="line">    std::ostream::operator&lt;&lt;(v19, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</span><br><span class="line">    std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;Here is your flag: flag&#123;&quot;, v20);</span><br><span class="line">    for ( l = 0LL; l &lt;= 0x27; ++l )</span><br><span class="line">      std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(</span><br><span class="line">        &amp;std::cout,</span><br><span class="line">        (unsigned int)(char)(v39[l] ^ (unsigned __int64)qword_605340[l]));</span><br><span class="line">    v22 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, &quot;&#125;&quot;, v21);</span><br><span class="line">    std::ostream::operator&lt;&lt;(v22, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  a3 = 0;</span><br><span class="line">LABEL_24:</span><br><span class="line">  std::string::~string((std::string *)&amp;v24);</span><br><span class="line">  sub_401F16(&amp;v31);</span><br><span class="line">  return a3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>I used IDA for the pseudocode. </p>
</blockquote>
<!-- wp:paragraph -->
<p>From the above code, you can see that there is a loop that iterates seven times which means that takes seven strings as input. And you can also observe that various functions are being called and our input is being hashed using MD5 and SHA. And at the end, it is compared with a string. i.e, our flag that is undergone MD5 and SHA hashed. Becoming more complicated -_-</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It becomes easy when you figure out that there is a function that checks our input, in which basic comparison is going on. Using GDB, diving into the function,  we can find that the exact comparison starts from here, <strong>0x401bc6</strong>. Lets start keeping a breakpoint here. In this location, you can see that our input is being stored(for comparison? :) ).</p>
<!-- /wp:paragraph -->
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x401bc6:	mov    BYTE PTR [rbp-0x25],al</span><br></pre></td></tr></table></figure>

<p>After this, the function checks if the byte from the input string is number or not(+,-,*,/). if the number byte is a numaric value, these instructions are followed next.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x401bed:	sub    eax,0x30</span><br><span class="line">0x401bf0:	cdqe   </span><br><span class="line">0x401bf2:	mov    QWORD PTR [rbp-0x18],rax</span><br><span class="line">0x401bf6:	cmp    QWORD PTR [rbp-0x18],0x0</span><br><span class="line">0x401bfb:	js     0x401c04</span><br><span class="line">0x401bfd:	cmp    QWORD PTR [rbp-0x18],0x9</span><br><span class="line">0x401c02:	jle    0x401c0e</span><br></pre></td></tr></table></figure>

<p>the comparison happens here.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">0x401cb7:	cmp    rax,QWORD PTR [rbp-0x8]</span><br><span class="line">0x401cbb:	je     0x401cc4</span><br><span class="line">0x401cbd:	mov    eax,0x1</span><br><span class="line">0x401cc2:	jmp    0x401cc9</span><br><span class="line">0x401cc4:	mov    eax,0x0</span><br><span class="line">0x401cc9:	test   al,al</span><br><span class="line">0x401ccb:	je     0x401cd7</span><br><span class="line">0x401ccd:	mov    eax,0x0</span><br><span class="line">0x401cd2:	jmp    0x401dd7</span><br><span class="line">0x401cd7:	mov    eax,DWORD PTR [rbp-0x24]</span><br></pre></td></tr></table></figure>

<p>If the selected byte is character(+,-,*,/), this function is called</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   0x401bc9:	cmp    BYTE PTR [rbp-0x27],0x0</span><br><span class="line">   0x401bcd:	je     0x401be2</span><br><span class="line">   0x401bcf:	movsx  eax,BYTE PTR [rbp-0x25]</span><br><span class="line">   0x401bd3:	mov    edi,eax</span><br><span class="line">=&gt; 0x401bd5:	call   0x401ad7</span><br></pre></td></tr></table></figure>

<p>this is what happening in the function(<strong>0x401ad17</strong>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0x401add:	mov    BYTE PTR [rbp-0x14],al</span><br><span class="line">0x401ae0:	movsx  eax,BYTE PTR [rbp-0x14]</span><br><span class="line">0x401ae4:	sub    eax,0x28</span><br><span class="line">0x401ae7:	cdqe   </span><br><span class="line">0x401ae9:	mov    QWORD PTR [rbp-0x8],rax</span><br><span class="line">0x401aed:	mov    rax,QWORD PTR [rbp-0x8]</span><br><span class="line">0x401af1:	cmp    rax,0x3</span><br><span class="line">0x401af5:	je     0x401b13</span><br><span class="line">0x401af7:	cmp    rax,0x3</span><br><span class="line">0x401afb:	jg     0x401b05</span><br><span class="line">0x401afd:	cmp    rax,0x2</span><br><span class="line">0x401b01:	je     0x401b21</span><br><span class="line">0x401b03:	jmp    0x401b2f</span><br><span class="line">0x401b05:	cmp    rax,0x5</span><br><span class="line">0x401b09:	je     0x401b1a</span><br><span class="line">0x401b0b:	cmp    rax,0x7</span><br></pre></td></tr></table></figure>

<p>Again the selected character byte is compared as usually. After the completion of the first input, the MD5 hash and SHA hash are updated here</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x40172e:	call   0x401110 &lt;MD5_Update@plt&gt;</span><br><span class="line">0x401767:	call   0x401140 &lt;SHA1_Update@plt&gt;</span><br></pre></td></tr></table></figure>

<p>Repeat the process for seven times and the correct value inputs will print you flag.</p>
<p>I hope this helps in solving the challenge. :)</p>
<blockquote>
<p>The flag is, flag{c0u8a_3dgety7_33hygt_donfos_9uck3d_up_NN}</p>
</blockquote>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Writeup/">Writeup</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/2019/06/20/ass/"><span>Assembly Language</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://img.vim-cn.com/cc/b3c73e9001c2c42a03e13fc1a3cd57afe5734c.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2019 By kh4l</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">Peace!</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>